{
    "identifier": "GetProducts",
    "title": "Get Products for create order",
    "description": null,
    "async": false,
    "queue": null,
    "debug": false,
    "entry": "GetProductsSource",
    "elements": [
        {
            "name": "GetProductsSource",
            "type": "source/entities",
            "options": {
                "with": [
                    "image",
                    "parent"
                ],
                "first": false,
                "limit": null,
                "fields": [],
                "global": false,
                "having": [],
                "module": "products",
                "offset": null,
                "scopes": [],
                "filters": [],
                "groupBy": [],
                "orderBy": [],
                "distinct": false,
                "listItems": null,
                "permissions": false,
                "withTrashed": false,
                "autoDistinct": true
            },
            "in": {},
            "set": {
                "products": "default:"
            },
            "to": {
                "default": {
                    "new-fox-29": [
                        "default"
                    ]
                }
            },
            "meta": {
                "position": [
                    477.93824586741187,
                    74.74402486813393
                ]
            }
        },
        {
            "name": "GetProducts",
            "type": "event/webhook",
            "options": {
                "module": null
            },
            "in": {},
            "set": {},
            "to": {
                "default": {
                    "InitArray": [
                        "default"
                    ]
                }
            },
            "meta": {
                "position": [
                    -313.36077860932744,
                    96.66159566213383
                ]
            }
        },
        {
            "name": "SetResponse",
            "type": "op/recipe",
            "options": {
                "recipe": "{\"products\": $array}"
            },
            "in": {},
            "set": {},
            "to": {
                "default": {
                    "Response": [
                        "default"
                    ]
                }
            },
            "meta": {
                "position": [
                    1599.063841365018,
                    166.46855677173994
                ]
            }
        },
        {
            "name": "Response",
            "type": "action/response",
            "options": {},
            "in": {},
            "set": {},
            "to": {},
            "meta": {
                "position": [
                    2119.381896490123,
                    45.86700941224056
                ]
            }
        },
        {
            "name": "new-fox-29",
            "type": "flow/each",
            "options": {},
            "in": {},
            "set": {
                "product": "each:"
            },
            "to": {
                "each": {
                    "cowardly-grasshopper-57": [
                        "default"
                    ]
                },
                "next": {
                    "RemoveChilds": [
                        "default"
                    ]
                }
            },
            "meta": {
                "position": [
                    814.2070135516327,
                    -44.27989488457861
                ]
            }
        },
        {
            "name": "cowardly-grasshopper-57",
            "type": "flow/if",
            "options": {
                "condition": "$product.product_type == \"group\""
            },
            "in": {},
            "set": {},
            "to": {
                "default": {
                    "plastic-crab-15": [
                        "default"
                    ]
                },
                "else": {
                    "rude-chicken-68": [
                        "item"
                    ]
                }
            },
            "meta": {
                "position": [
                    1134.8300810048324,
                    -99.94249967606716
                ]
            }
        },
        {
            "name": "plastic-crab-15",
            "type": "op/recipe",
            "options": {
                "recipe": "$product.map(p => {...p, \"childs\": $products.filter(el => el.parent.id == p.id) })[0]"
            },
            "in": {},
            "set": {
                "product": "default:"
            },
            "to": {
                "default": {
                    "rude-chicken-68": [
                        "item"
                    ]
                }
            },
            "meta": {
                "position": [
                    1464.5241138774757,
                    -231.37901957302108
                ]
            }
        },
        {
            "name": "InitArray",
            "type": "op/recipe",
            "options": {
                "recipe": "[]"
            },
            "in": {},
            "set": {
                "array": "default:"
            },
            "to": {
                "default": {
                    "GetProductsSource": [
                        "default"
                    ]
                }
            },
            "meta": {
                "position": [
                    98.9692434250399,
                    132.4908137121681
                ]
            }
        },
        {
            "name": "rude-chicken-68",
            "type": "op/push",
            "options": {},
            "in": {
                "array": "$array"
            },
            "set": {
                "array": "default:"
            },
            "to": {},
            "meta": {
                "position": [
                    1886.7032321738009,
                    -244.0986490509132
                ]
            }
        },
        {
            "name": "RemoveChilds",
            "type": "op/recipe",
            "options": {
                "recipe": "$array.filter(el => el.parent == null)"
            },
            "in": {},
            "set": {
                "array": "default:"
            },
            "to": {
                "default": {
                    "SetResponse": [
                        "default"
                    ]
                }
            },
            "meta": {
                "position": [
                    1219.9176271792292,
                    185.57357158254493
                ]
            }
        }
    ],
    "events": [
        {
            "identifier": "GetProducts",
            "type": "webhook",
            "module": null
        }
    ],
    "comments": []
}
