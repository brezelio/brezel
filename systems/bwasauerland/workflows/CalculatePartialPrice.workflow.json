{
    "identifier": "CalculatePartialPrice",
    "title": "Calculate the partial price ",
    "description": null,
    "async": false,
    "debug": false,
    "entry": "OnChangeSelectAmount",
    "elements": [
        {
            "name": "OnChangeSelectAmount",
            "type": "event/on_change",
            "options": {
                "async": false,
                "title": null,
                "module": null
            },
            "in": {},
            "set": {
                "part": "value:",
                "project": ":default"
            },
            "to": {
                "default": {
                    "CheckRestAmount": [
                        "default"
                    ]
                }
            },
            "meta": {
                "position": [
                    0,
                    -334.5
                ]
            }
        },
        {
            "name": "CheckRestAmount",
            "type": "flow/if",
            "options": {
                "condition": "$part == \"rest\" || !$part\t"
            },
            "in": {},
            "set": {},
            "to": {
                "default": {
                    "calculateAmount": [
                        "default"
                    ]
                },
                "else": {
                    "convertStringToNumber": [
                        "default"
                    ]
                }
            },
            "meta": {
                "position": [
                    338,
                    -129.5
                ]
            }
        },
        {
            "name": "convertStringToNumber",
            "type": "op/strReplace",
            "options": {
                "text": "$part",
                "search": "a"
            },
            "in": {},
            "set": {
                "selected_amount": "default:"
            },
            "to": {
                "default": {
                    "calculateAmount": [
                        "default"
                    ]
                }
            },
            "meta": {
                "position": [
                    676,
                    0
                ]
            }
        },
        {
            "name": "calculateAmount",
            "type": "op/recipe",
            "options": {
                "recipe": "$part && $part != \"rest\" ? round(($project.price_total / $selected_amount ?? 1),2) : $project.invoice_open_position"
            },
            "in": {},
            "set": {
                "invoice_amount": "default:"
            },
            "to": {
                "default": {
                    "setValue": [
                        "default"
                    ]
                }
            },
            "meta": {
                "position": [
                    676,
                    -233
                ]
            }
        },
        {
            "name": "setValue",
            "type": "action/set",
            "options": {
                "add": [],
                "copy": null,
                "recipes": {
                    "amount": "$invoice_amount"
                },
                "properties": []
            },
            "in": {},
            "set": {},
            "to": {},
            "meta": {
                "position": [
                    1014,
                    -104.5
                ]
            }
        }
    ],
    "events": [
        {
            "identifier": "OnChangeSelectAmount",
            "type": "on_change",
            "module": null,
            "async": false,
            "title": null
        }
    ],
    "comments": []
}
